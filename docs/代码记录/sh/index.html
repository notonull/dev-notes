<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.20" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><meta property="og:url" content="https://github.com/notonull/logic-hub/%E4%BB%A3%E7%A0%81%E8%AE%B0%E5%BD%95/sh/"><meta property="og:site_name" content="aGeng 's Blog"><meta property="og:title" content="Docker Compose 部署脚本系统"><meta property="og:description" content="这是一个模块化的Docker服务部署脚本系统，支持统一管理多个Docker服务的生命周期。 目录结构 功能特性 主脚本功能 统一管理: 通过主脚本统一管理所有子服务脚本 批量操作: 支持对所有服务执行批量操作 安全确认: 危险操作需要用户确认 模块化设计: 子脚本可独立运行 日志系统: 统一的彩色日志输出 子脚本功能 标准化配置: 统一的变量命名规范 ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-16T18:59:39.000Z"><meta property="article:modified_time" content="2025-09-16T18:59:39.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Docker Compose 部署脚本系统","image":[""],"dateModified":"2025-09-16T18:59:39.000Z","author":[]}</script><link rel="icon" type="image/png" href="https://theme-plume.vuejs.press/favicon-32x32.png"><title>Docker Compose 部署脚本系统 | aGeng 's Blog</title><meta name="description" content="这是一个模块化的Docker服务部署脚本系统，支持统一管理多个Docker服务的生命周期。 目录结构 功能特性 主脚本功能 统一管理: 通过主脚本统一管理所有子服务脚本 批量操作: 支持对所有服务执行批量操作 安全确认: 危险操作需要用户确认 模块化设计: 子脚本可独立运行 日志系统: 统一的彩色日志输出 子脚本功能 标准化配置: 统一的变量命名规范 ..."><link rel="preload" href="/logic-hub/assets/style-DU_lyx4_.css" as="style"><link rel="stylesheet" href="/logic-hub/assets/style-DU_lyx4_.css"><link rel="modulepreload" href="/logic-hub/assets/app-rRErtsSn.js"><link rel="modulepreload" href="/logic-hub/assets/index.html-D_o6p5eJ.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-68cd6b44><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-68cd6b44 data-v-d34f28d6><div class="vp-navbar" vp-navbar data-v-d34f28d6 data-v-70d97d16><div class="wrapper" data-v-70d97d16><div class="container" data-v-70d97d16><div class="title" data-v-70d97d16><div class="vp-navbar-title" data-v-70d97d16 data-v-1a4f50af><a class="vp-link no-icon link title" href="/logic-hub/" data-v-1a4f50af data-v-442a52aa><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-eda4b9bd><!--]--><!--[--><img class="vp-image light logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-eda4b9bd><!--]--><!--]--><!--]--><span data-v-1a4f50af>aGeng &#39;s Blog</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-70d97d16><div class="content-body" data-v-70d97d16><!--[--><!--]--><div class="vp-navbar-search search" data-v-70d97d16><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-70d97d16 data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/logic-hub/" tabindex="0" data-v-d43c1732 data-v-9970a379 data-v-442a52aa><!--[--><!----><span data-v-9970a379>首页</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/logic-hub/blog/" tabindex="0" data-v-d43c1732 data-v-9970a379 data-v-442a52aa><!--[--><!----><span data-v-9970a379>博客</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/logic-hub/blog/tags/" tabindex="0" data-v-d43c1732 data-v-9970a379 data-v-442a52aa><!--[--><!----><span data-v-9970a379>标签</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/logic-hub/blog/archives/" tabindex="0" data-v-d43c1732 data-v-9970a379 data-v-442a52aa><!--[--><!----><span data-v-9970a379>归档</span><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-feafea4e><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-feafea4e><span class="text" data-v-feafea4e><!----><!----><span data-v-feafea4e>笔记</span><span class="vpi-chevron-down text-icon" data-v-feafea4e></span></span></button><div class="menu" data-v-feafea4e><div class="vp-menu" data-v-feafea4e data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-aaf95230><a class="vp-link no-icon link" href="/logic-hub/demo/" data-v-aaf95230 data-v-442a52aa><!--[--><!----> 示例<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="vp-navbar-appearance appearance" data-v-70d97d16 data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-d84fedac><span class="check" data-v-d84fedac><span class="icon" data-v-d84fedac><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-70d97d16 data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/notonull/logic-hub" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-70d97d16 data-v-652282fd data-v-feafea4e><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-feafea4e><span class="vpi-more-horizontal icon" data-v-feafea4e></span></button><div class="menu" data-v-feafea4e><div class="vp-menu" data-v-feafea4e data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>外观</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-d84fedac><span class="check" data-v-d84fedac><span class="icon" data-v-d84fedac><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/notonull/logic-hub" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-70d97d16 data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-70d97d16><div class="divider-line" data-v-70d97d16></div></div></div><!----></header><!----><!----><!--[--><div id="VPContent" vp-content class="vp-content" data-v-68cd6b44 data-v-eb709286><div class="vp-doc-container has-aside" data-v-eb709286 data-v-e91ad060><!--[--><!--]--><div class="container" data-v-e91ad060><div class="aside" vp-outline data-v-e91ad060><div class="aside-curtain" data-v-e91ad060></div><div class="aside-container" data-v-e91ad060><div class="aside-content" data-v-e91ad060><div class="vp-doc-aside" data-v-e91ad060 data-v-5976474c><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-5976474c data-v-aa56eba0><div class="content" data-v-aa56eba0><div class="outline-marker" data-v-aa56eba0></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-aa56eba0><span data-v-aa56eba0>此页内容</span><span class="vpi-print icon" data-v-aa56eba0></span></div><ul class="root" data-v-aa56eba0 data-v-3e6b023c><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5976474c></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-e91ad060><div class="content-container" data-v-e91ad060><!--[--><!--]--><main class="main" data-v-e91ad060><!----><!--[--><h1 class="vp-doc-title page-title" data-v-7e9208b4>Docker Compose 部署脚本系统 <!----></h1><div class="vp-doc-meta" data-v-7e9208b4><p class="reading-time" data-v-7e9208b4><span class="vpi-books icon" data-v-7e9208b4></span><span data-v-7e9208b4>约 1027 字</span><span data-v-7e9208b4>大约 3 分钟</span></p><!----><!----></div><!--]--><div class="_%E4%BB%A3%E7%A0%81%E8%AE%B0%E5%BD%95_sh_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-e91ad060><div data-v-e91ad060><p>这是一个模块化的Docker服务部署脚本系统，支持统一管理多个Docker服务的生命周期。</p><h2 id="目录结构" tabindex="-1"><a class="header-anchor" href="#目录结构"><span>目录结构</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>.</span></span>
<span class="line"><span>├── docker-compose-deploy.sh    # 主脚本 (v2.0)</span></span>
<span class="line"><span>├── deploy/                     # 子脚本目录</span></span>
<span class="line"><span>│   └── jenkins.sh             # Jenkins服务部署脚本 (v2.0)</span></span>
<span class="line"><span>├── lib/                        # 🆕 公共库目录</span></span>
<span class="line"><span>│   ├── logger.sh              # 日志工具库</span></span>
<span class="line"><span>│   ├── docker_utils.sh        # Docker操作库</span></span>
<span class="line"><span>│   ├── system_utils.sh        # 系统工具库</span></span>
<span class="line"><span>│   └── config_utils.sh        # 配置管理库</span></span>
<span class="line"><span>├── README.md                  # 说明文档</span></span>
<span class="line"><span>├── USAGE_EXAMPLES.md          # 使用示例</span></span>
<span class="line"><span>└── DEMO.md                    # 重构演示文档</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="功能特性" tabindex="-1"><a class="header-anchor" href="#功能特性"><span>功能特性</span></a></h2><h3 id="主脚本功能" tabindex="-1"><a class="header-anchor" href="#主脚本功能"><span>主脚本功能</span></a></h3><ul><li><strong>统一管理</strong>: 通过主脚本统一管理所有子服务脚本</li><li><strong>批量操作</strong>: 支持对所有服务执行批量操作</li><li><strong>安全确认</strong>: 危险操作需要用户确认</li><li><strong>模块化设计</strong>: 子脚本可独立运行</li><li><strong>日志系统</strong>: 统一的彩色日志输出</li></ul><h3 id="子脚本功能" tabindex="-1"><a class="header-anchor" href="#子脚本功能"><span>子脚本功能</span></a></h3><ul><li><strong>标准化配置</strong>: 统一的变量命名规范</li><li><strong>完整生命周期</strong>: 支持服务的完整生命周期管理</li><li><strong>状态检查</strong>: 实时获取服务状态</li><li><strong>错误处理</strong>: 完善的错误检查和处理</li></ul><h2 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法"><span>使用方法</span></a></h2><h3 id="主脚本命令" tabindex="-1"><a class="header-anchor" href="#主脚本命令"><span>主脚本命令</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 显示帮助信息</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> help</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看配置信息</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">           # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 拉取镜像 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">             # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装服务 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">          # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动服务 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">               # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">       # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 停止服务 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> down</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">             # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> down</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 卸载服务 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> uninstall</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> uninstall</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 删除镜像 (需要确认)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rmi</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">              # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rmi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 指定服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看日志 (必须指定服务)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看服务信息</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> info</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">             # 所有服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./docker-compose-deploy.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> info</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jenkins</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     # 指定服务</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="子脚本独立使用" tabindex="-1"><a class="header-anchor" href="#子脚本独立使用"><span>子脚本独立使用</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 可以直接运行子脚本</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./deploy/jenkins.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./deploy/jenkins.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> info</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./deploy/jenkins.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置说明" tabindex="-1"><a class="header-anchor" href="#配置说明"><span>配置说明</span></a></h2><h3 id="变量命名规范" tabindex="-1"><a class="header-anchor" href="#变量命名规范"><span>变量命名规范</span></a></h3><h4 id="基础变量-base-前缀" tabindex="-1"><a class="header-anchor" href="#基础变量-base-前缀"><span>基础变量 (base_ 前缀)</span></a></h4><ul><li><code>base_image_name</code>: Docker镜像名称</li><li><code>base_container_name</code>: 容器名称</li><li><code>base_install_path</code>: 安装路径</li><li><code>base_ip</code>: 服务器IP地址</li></ul><h4 id="环境变量-env-前缀" tabindex="-1"><a class="header-anchor" href="#环境变量-env-前缀"><span>环境变量 (env_ 前缀)</span></a></h4><ul><li><code>env_ports</code>: 端口映射数组</li><li><code>env_volumes</code>: 卷挂载数组</li><li><code>env_environment</code>: 环境变量数组</li></ul><h3 id="日志系统" tabindex="-1"><a class="header-anchor" href="#日志系统"><span>日志系统</span></a></h3><p>提供统一的日志函数：</p><ul><li><code>log_info</code>: 信息日志 (绿色)</li><li><code>log_warn</code>: 警告日志 (黄色)</li><li><code>log_error</code>: 错误日志 (红色)</li><li><code>log_step</code>: 步骤日志 (蓝色)</li></ul><h3 id="服务状态" tabindex="-1"><a class="header-anchor" href="#服务状态"><span>服务状态</span></a></h3><ul><li><strong>运行中</strong> (绿色): 容器正在运行</li><li><strong>已停止</strong> (黄色): 容器已停止</li><li><strong>未安装</strong> (红色): 服务未安装</li><li><strong>未知状态</strong> (红色): 无法确定状态</li></ul><h2 id="jenkins-服务说明" tabindex="-1"><a class="header-anchor" href="#jenkins-服务说明"><span>Jenkins 服务说明</span></a></h2><h3 id="默认配置" tabindex="-1"><a class="header-anchor" href="#默认配置"><span>默认配置</span></a></h3><ul><li><strong>镜像</strong>: jenkins/jenkins:lts</li><li><strong>端口</strong>: 8080 (Web界面), 50000 (JNLP)</li><li><strong>数据目录</strong>: /opt/server/jenkins/data</li><li><strong>日志目录</strong>: /opt/server/jenkins/logs</li><li><strong>时区</strong>: Asia/Shanghai</li></ul><h3 id="安装后操作" tabindex="-1"><a class="header-anchor" href="#安装后操作"><span>安装后操作</span></a></h3><ol><li>访问 http://您的IP:8080/</li><li>使用显示的初始管理员密码进行初始化</li><li>安装推荐的插件</li><li>创建管理员用户</li></ol><h2 id="扩展新服务" tabindex="-1"><a class="header-anchor" href="#扩展新服务"><span>扩展新服务</span></a></h2><h3 id="_1-创建子脚本" tabindex="-1"><a class="header-anchor" href="#_1-创建子脚本"><span>1. 创建子脚本</span></a></h3><p>在 <code>deploy/</code> 目录下创建新的服务脚本，例如 <code>deploy/nginx.sh</code></p><h3 id="_2-注册服务" tabindex="-1"><a class="header-anchor" href="#_2-注册服务"><span>2. 注册服务</span></a></h3><p>在主脚本的 <code>REGISTERED_SCRIPTS</code> 中添加映射：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REGISTERED_SCRIPTS[</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">&quot;nginx&quot;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">&quot;deploy/nginx.sh&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-实现标准函数" tabindex="-1"><a class="header-anchor" href="#_3-实现标准函数"><span>3. 实现标准函数</span></a></h3><p>子脚本需要实现以下函数：</p><ul><li><code>cmd_config</code>: 显示配置</li><li><code>cmd_pull</code>: 拉取镜像</li><li><code>cmd_install</code>: 安装服务</li><li><code>cmd_uninstall</code>: 卸载服务</li><li><code>cmd_down</code>: 停止服务</li><li><code>cmd_up</code>: 启动服务</li><li><code>cmd_rmi</code>: 删除镜像</li><li><code>cmd_logs</code>: 查看日志</li><li><code>cmd_info</code>: 显示信息</li><li><code>cmd_help</code>: 显示帮助</li></ul><h2 id="系统要求" tabindex="-1"><a class="header-anchor" href="#系统要求"><span>系统要求</span></a></h2><ul><li>Linux/Unix 系统</li><li>Bash 4.0+</li><li>Docker</li><li>Docker Compose</li></ul><h2 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h2><ol><li>批量操作时会要求用户确认，确保安全性</li><li>子脚本可以独立运行，不依赖主脚本</li><li>所有危险操作都有确认提示</li><li>日志会显示时间戳和彩色标识</li><li>支持通过环境变量自定义配置</li></ol><h2 id="故障排除" tabindex="-1"><a class="header-anchor" href="#故障排除"><span>故障排除</span></a></h2><h3 id="权限问题" tabindex="-1"><a class="header-anchor" href="#权限问题"><span>权限问题</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +x</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker-compose-deploy.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +x</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deploy/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="docker权限问题" tabindex="-1"><a class="header-anchor" href="#docker权限问题"><span>Docker权限问题</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> usermod</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -aG</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $USER</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 重新登录或执行</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">newgrp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="服务端口冲突" tabindex="-1"><a class="header-anchor" href="#服务端口冲突"><span>服务端口冲突</span></a></h3><p>检查并修改子脚本中的端口配置，或停止冲突的服务。</p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-e91ad060 data-v-fda6bbae><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-fda6bbae><span class="contributors-label" data-v-fda6bbae>贡献者: </span><span class="contributors-info" data-v-fda6bbae><!--[--><!--[--><span class="contributor" data-v-fda6bbae>ronggeng.chen</span><!----><!--]--><!--]--></span></div><!----></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-68cd6b44 data-v-f098172b><span class="percent" data-allow-mismatch data-v-f098172b>0%</span><span class="show icon vpi-back-to-top" data-v-f098172b></span><svg aria-hidden="true" data-v-f098172b><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-f098172b></circle></svg></button><footer class="vp-footer" vp-footer data-v-68cd6b44 data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>探索、思考、创造</p><p class="copyright" data-v-400675cf>© 2025 aGeng. All Rights Reserved.</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/logic-hub/assets/app-rRErtsSn.js" defer></script></body></html>