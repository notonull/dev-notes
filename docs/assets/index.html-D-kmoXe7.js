import{_ as n,e as l,f as i,g as h,i as e,j as t,r as k,o as p,h as d}from"./app-SijNYx2B.js";const r={};function g(E,s){const a=k("RouteLink");return p(),l("div",null,[s[1]||(s[1]=i('<h2 id="_1-参考" tabindex="-1"><a class="header-anchor" href="#_1-参考"><span>1.参考</span></a></h2><p><strong>官方地址:</strong> http://test.com</p><h2 id="_2-前置条件" tabindex="-1"><a class="header-anchor" href="#_2-前置条件"><span>2.前置条件</span></a></h2><p><strong>系统版本:</strong> any</p><p><strong>软件依赖:</strong> oracle</p><p><strong>权限要求:</strong> any</p><p>**网络要求: **any</p><p><strong>其他注意事项:</strong> any</p><h2 id="_3-环境准备" tabindex="-1"><a class="header-anchor" href="#_3-环境准备"><span>3.环境准备</span></a></h2><h2 id="_4-安装部署" tabindex="-1"><a class="header-anchor" href="#_4-安装部署"><span>4.安装部署</span></a></h2>',10)),h("p",null,[e(a,{to:"/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E7%BB%B4/Oracle/%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E6%96%87%E6%A1%A3.html"},{default:t(()=>s[0]||(s[0]=[d("引用路径文档")])),_:1})]),s[2]||(s[2]=i(`<h2 id="_5-配置说明" tabindex="-1"><a class="header-anchor" href="#_5-配置说明"><span>5.配置说明</span></a></h2><h3 id="_5-1-开启binlog模式" tabindex="-1"><a class="header-anchor" href="#_5-1-开启binlog模式"><span>5.1.开启BinLog模式</span></a></h3><h4 id="_5-1-1-查询数据库归档模式" tabindex="-1"><a class="header-anchor" href="#_5-1-1-查询数据库归档模式"><span>5.1.1.查询数据库归档模式</span></a></h4><p><strong>描述</strong>：检查数据库是否启用归档模式。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> LOG_MODE </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DATABASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例</strong>：</p><table><thead><tr><th>LOG_MODE</th></tr></thead><tbody><tr><td>ARCHIVELOG</td></tr></tbody></table><h4 id="_5-1-2-启用数据库级别补充日志" tabindex="-1"><a class="header-anchor" href="#_5-1-2-启用数据库级别补充日志"><span>5.1.2.启用数据库级别补充日志</span></a></h4><p><strong>描述</strong>：开启数据库级别的补充日志，为 LogMiner 做准备。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATABASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ADD</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SUPPLEMENTAL </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LOG</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATA</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例</strong>：成功执行，无返回结果</p><h4 id="_5-1-3-启用表级全字段补充日志" tabindex="-1"><a class="header-anchor" href="#_5-1-3-启用表级全字段补充日志"><span>5.1.3.启用表级全字段补充日志</span></a></h4><p><strong>描述</strong>：为特定表开启全列补充日志。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">模式</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">表名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ADD</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SUPPLEMENTAL </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LOG</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATA</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (ALL) COLUMNS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例</strong>：成功执行，无返回结果</p><p><strong>参数说明</strong>：</p><ul><li><code>&quot;模式&quot;</code>：表所属 schema</li><li><code>&quot;表名&quot;</code>：需要补充日志的表</li></ul><h3 id="_5-2-创建cdc用户" tabindex="-1"><a class="header-anchor" href="#_5-2-创建cdc用户"><span>5.2.创建CDC用户</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 1️⃣ 创建 CDC/LogMiner 专用表空间</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 注意：路径需提前在操作系统创建，Oracle 进程需有权限</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLESPACE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> CDC_TBS</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">DATAFILE </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/opt/oracle/oradata/SID/cdc_tbs.dbf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SIZE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 25M REUSE</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">AUTOEXTEND </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MAXSIZE </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">UNLIMITED</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 可选：创建临时表空间用于排序和临时操作</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> TEMPORARY TABLESPACE CDC_TBS_TMP</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">TEMPFILE </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/opt/oracle/oradata/SID/cdc_tbs_tmp.dbf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SIZE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 50M REUSE</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">AUTOEXTEND </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MAXSIZE 2G;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 2️⃣ 创建 CDC/LogMiner 专用用户</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> USER</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> cdc_user</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> IDENTIFIED </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 密码</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  DEFAULT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> TABLESPACE CDC_TBS</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  TEMPORARY TABLESPACE CDC_TBS_TMP</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  QUOTA </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">UNLIMITED</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CDC_TBS;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 3️⃣ 基本连接权限</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SESSION</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 登录数据库</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CONTAINER </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;   </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 如果是 CDB，可切换 PDB</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 4️⃣ 用户自身 schema 权限（建表/序列/过程/视图）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SEQUENCE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> PROCEDURE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> VIEW </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> RESOURCE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;        </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- schema 内对象管理权限</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 5️⃣ LogMiner 必需权限</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> LOGMINING </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;                </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 使用 LogMiner</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ANY </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TRANSACTION</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;   </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 查询 redo log 事务</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> EXECUTE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBMS_LOGMNR </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;   </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- LogMiner 包</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> EXECUTE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DBMS_LOGMNR_D </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user; </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- LogMiner 辅助包</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 6️⃣ 系统视图访问权限（redo / archive 日志）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DATABASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LOG</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$LOGFILE </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$LOG_HISTORY </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$ARCHIVED_LOG </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$ARCHIVE_DEST_STATUS </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$LOGMNR_LOGS </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$LOGMNR_CONTENTS </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V_$LOGMNR_PARAMETERS </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> cdc_user;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 7️⃣ 可选：指定业务表只读权限（按需添加）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ===========================================</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- GRANT SELECT ON schema_name.table_name TO cdc_user;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-测试logmnr监控" tabindex="-1"><a class="header-anchor" href="#_5-3-测试logmnr监控"><span>5.3.测试Logmnr监控</span></a></h3><h4 id="_5-3-1-查询-log-文件位置" tabindex="-1"><a class="header-anchor" href="#_5-3-1-查询-log-文件位置"><span>5.3.1. 查询 log 文件位置</span></a></h4><p><strong>描述</strong>：查看数据库 log 文件路径及状态，为 LogMiner 添加日志做准备。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">## 增量日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGFILE;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">## 归档日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$ARCHIVED_LOG</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出示例</strong>：</p><table><thead><tr><th>GROUP#</th><th>MEMBER</th><th>STATUS</th></tr></thead><tbody><tr><td>1</td><td>/oradata/redo01.log</td><td>ACTIVE</td></tr><tr><td>2</td><td>/oradata/redo02.log</td><td>INACTIVE</td></tr></tbody></table><p><strong>参数说明</strong>：无</p><h4 id="_5-3-2-添加-log-文件到-logminer" tabindex="-1"><a class="header-anchor" href="#_5-3-2-添加-log-文件到-logminer"><span>5.3.2.添加 log 文件到 LogMiner</span></a></h4><p><strong>描述</strong>：将 log 文件加入 LogMiner 会话。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADD_LOGFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(LOGFILENAME </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/home/oracle/app/oracle/oradata/helowin/redo01.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">NEW</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADD_LOGFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(LOGFILENAME </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/home/oracle/app/oracle/oradata/helowin/redo02.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADDFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADD_LOGFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(LOGFILENAME </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/home/oracle/app/oracle/oradata/helowin/redo03.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADDFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出示例</strong>：成功执行，无返回结果</p><p><strong>参数说明</strong>：</p><ul><li><p><code>LOGFILENAME</code>：日志文件完整路径</p></li><li><p><code>OPTIONS</code>：</p><ul><li><code>DBMS_LOGMNR.NEW</code>：新建日志列表</li><li><code>DBMS_LOGMNR.ADDFILE</code>：追加文件</li><li><code>DBMS_LOGMNR.REMOVEFILE</code>：移除文件</li></ul></li></ul><h4 id="_5-3-3-查询已添加监控日志文件" tabindex="-1"><a class="header-anchor" href="#_5-3-3-查询已添加监控日志文件"><span>5.3.3.查询已添加监控日志文件</span></a></h4><p><strong>描述</strong>：查看当前 LogMiner 会话已添加的日志文件列表。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGMNR_LOGS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>输出示例</strong>：</p><table><thead><tr><th>LOGFILENAME</th><th>STATUS</th></tr></thead><tbody><tr><td>/oradata/redo01.log</td><td>ADDED</td></tr><tr><td>/oradata/redo02.log</td><td>ADDED</td></tr></tbody></table><p><strong>参数说明</strong>：无</p><h4 id="_5-3-4-启动-logminer" tabindex="-1"><a class="header-anchor" href="#_5-3-4-启动-logminer"><span>5.3.4.启动 LogMiner</span></a></h4><p><strong>描述</strong>：启动日志监控，会话开始解析 redo 日志。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">START_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">DICT_FROM_ONLINE_CATALOG</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">               DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">COMMITTED_DATA_ONLY</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  );</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出示例</strong>：成功执行，无返回结果</p><p><strong>参数说明</strong>：</p><ul><li><code>DICT_FROM_ONLINE_CATALOG</code>：使用在线字典</li><li><code>COMMITTED_DATA_ONLY</code>：仅查询已提交数据</li></ul><h4 id="_5-3-5-查询-logminer-内容" tabindex="-1"><a class="header-anchor" href="#_5-3-5-查询-logminer-内容"><span>5.3.5.查询 LogMiner 内容</span></a></h4><p><strong>描述</strong>：查看指定表的增量变更。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SCN, </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">TIMESTAMP</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPERATION, TABLE_NAME, SQL_REDO, SQL_UNDO </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGMNR_CONTENTS </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- WHERE TABLE_NAME = &#39;CG_DEPO_PE&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- AND SCN BETWEEN 123450 AND 123460</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> TIMESTAMP</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出示例</strong>：</p><table><thead><tr><th>SCN</th><th>TIMESTAMP</th><th>OPERATION</th><th>TABLE_NAME</th><th>SQL_REDO</th><th>SQL_UNDO</th></tr></thead><tbody><tr><td>123456</td><td>2025-08-29 11:10:00</td><td>INSERT</td><td>CG_DEPO_PE</td><td>INSERT INTO CG_DEPO_PE VALUES(...)</td><td>DELETE FROM CG_DEPO_PE WHERE...</td></tr></tbody></table><p><strong>参数说明</strong>：</p><ul><li><code>TABLE_NAME</code>：指定查询表名</li><li><code>SCN</code>：指定查询表名</li></ul><h4 id="_5-3-6-停止-logminer" tabindex="-1"><a class="header-anchor" href="#_5-3-6-停止-logminer"><span>5.3.6. 停止 LogMiner</span></a></h4><p><strong>描述</strong>：停止 LogMiner 会话，释放资源。</p><p><strong>SQL</strong>：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">END_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出示例</strong>：成功执行，无返回结果</p><p><strong>参数说明</strong>：无</p><h2 id="_6-常用操作" tabindex="-1"><a class="header-anchor" href="#_6-常用操作"><span>6.常用操作</span></a></h2><h3 id="_6-1-查询指令" tabindex="-1"><a class="header-anchor" href="#_6-1-查询指令"><span>6.1.查询指令</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 查询数据库归档模式</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> LOG_MODE </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DATABASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 增量日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGFILE;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 归档日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$ARCHIVED_LOG</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2-设置指令" tabindex="-1"><a class="header-anchor" href="#_6-2-设置指令"><span>6.2.设置指令</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 启用数据库级别补充日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATABASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ADD</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SUPPLEMENTAL </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LOG</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATA</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 启用表级全字段补充日志</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">模式</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">表名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ADD</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SUPPLEMENTAL </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LOG</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATA</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (ALL) COLUMNS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-logmnr指令" tabindex="-1"><a class="header-anchor" href="#_6-3-logmnr指令"><span>6.3.Logmnr指令</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 添加 log 文件到 LogMiner</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">ADD_LOGFILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(LOGFILENAME </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">log path</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">NEW</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 查询已添加监控日志文件</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGMNR_LOGS;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 启动 LogMiner</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">START_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    OPTIONS </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">DICT_FROM_ONLINE_CATALOG</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">               DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">COMMITTED_DATA_ONLY</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  );</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 查询 LogMiner 内容</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SCN, </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">TIMESTAMP</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, OPERATION, TABLE_NAME, SQL_REDO, SQL_UNDO </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> V$LOGMNR_CONTENTS </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> TIMESTAMP</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 停止 LogMiner</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  DBMS_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">END_LOGMNR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-排错与日志" tabindex="-1"><a class="header-anchor" href="#_7-排错与日志"><span>7.排错与日志</span></a></h2><h2 id="_8-升级与维护" tabindex="-1"><a class="header-anchor" href="#_8-升级与维护"><span>8.升级与维护</span></a></h2><h2 id="_9-附录" tabindex="-1"><a class="header-anchor" href="#_9-附录"><span>9.附录</span></a></h2>`,75))])}const A=n(r,[["render",g],["__file","index.html.vue"]]),c=JSON.parse(`{"path":"/blog/hn7ynkvy/","title":"Oracle Logmnr补全日志操作说明","lang":"zh-CN","frontmatter":{"title":"Oracle Logmnr补全日志操作说明","copyright":"CC-BY-4.0","tags":["oracle","binlog"],"createTime":"2025/09/17 10:52:52","permalink":"/blog/hn7ynkvy/","description":"1.参考 官方地址: http://test.com 2.前置条件 系统版本: any 软件依赖: oracle 权限要求: any **网络要求: **any 其他注意事项: any 3.环境准备 4.安装部署 5.配置说明 5.1.开启BinLog模式 5.1.1.查询数据库归档模式 描述：检查数据库是否启用归档模式。 SQL： 输出示例： 5.1...","head":[["meta",{"property":"og:url","content":"https://notonull.github.io/dev-notes/blog/hn7ynkvy/"}],["meta",{"property":"og:site_name","content":"aGeng 's Blog"}],["meta",{"property":"og:title","content":"Oracle Logmnr补全日志操作说明"}],["meta",{"property":"og:description","content":"1.参考 官方地址: http://test.com 2.前置条件 系统版本: any 软件依赖: oracle 权限要求: any **网络要求: **any 其他注意事项: any 3.环境准备 4.安装部署 5.配置说明 5.1.开启BinLog模式 5.1.1.查询数据库归档模式 描述：检查数据库是否启用归档模式。 SQL： 输出示例： 5.1..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-26T17:22:13.000Z"}],["meta",{"property":"article:tag","content":"oracle"}],["meta",{"property":"article:tag","content":"binlog"}],["meta",{"property":"article:modified_time","content":"2025-09-26T17:22:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Oracle Logmnr补全日志操作说明\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-26T17:22:13.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":3.93,"words":1178},"git":{"updatedTime":1758907333000,"contributors":[{"name":"ronggeng.chen","username":"ronggeng.chen","email":"chen.ronggeng.email@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/ronggeng.chen?v=4","url":"https://github.com/ronggeng.chen"},{"name":"ops_chengeng","username":"ops_chengeng","email":"ops_chengeng@demo.com","commits":1,"avatar":"https://avatars.githubusercontent.com/ops_chengeng?v=4","url":"https://github.com/ops_chengeng"}]},"autoDesc":true,"filePathRelative":"数据库运维/Oracle/Oracle Logmnr补全日志操作说明.md","categoryList":[{"id":"5d7420","sort":10002,"name":"数据库运维"},{"id":"1650f4","sort":10003,"name":"Oracle"}]}`);export{A as comp,c as data};
